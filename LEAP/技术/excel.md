### 文本类型

excel 4种文本类型：数值、文本、日期、函数


数值：用于直接计算；
时间：
如果想在 Excel 中正确输入日期，例如“2014/1/1”这样，公历公元纪年法的年、月、日分别用“/”（斜线）隔开，以半角格式输入。
输入时间时需要则像“13:00”一样，将小时与分钟用“:（冒号）”隔开，以半角格式输入。
<u>像这样表示日期、时间的数据形式实际上就是“序列值”</u>。由此可见，在 Excel 中日期和时间也可看作是数值的一种。
另外说明一点，Excel 可表示的日期范围是从1900/1/1到9999/12/31。


## 函数
### 常用
#### count  &  counta
counta() 数出目标范围内所有非空的单元格的个数
count()  数出目标范围内所有为数值类型的单元格的个数


#### countif 条件计数
==通过使用 COUNTIF 函数，我们可以检查数据是否重复、确认指定数据是否存在、单元格中是否包含指定文本，等等。这是一个十分方便的重要函数，请一定要掌握。==

**➊ 在单元格 I2中输入以下公式，计算 A 列中有单元格 G2数值的数目（即“吉田”）有多少。**

=COUNTIF(A:A,G2)
-   第一参数：计算其中非空单元格数目的区域
-   第二参数：在第一参数的指定范围内计算数目的条件

![COUNTIF函数：如何计算每名负责人员的销售件数-Excel22|400](https://www.dgxue.com/excel/img1/image00286.jpeg)

**➋ 按回车键后，单元格 I2中显示的数值表示：A 列中出现的与 G2有相同值的单元格（即“吉田”）的数目。**

![COUNTIF函数：如何计算每名负责人员的销售件数-Excel22|400](https://www.dgxue.com/excel/img1/image00291.jpeg)

#### sumif
-   第一参数：用于条件判断的单元格区域
-   第二参数：在第一参数指定的范围里，需要计算总和的行的判定条件
-   第三参数：实际求和的区域

按照步骤1输入“=SUMIF(A:A,G2,D:D)”这一公式，Excel 会自动识别，做出以下的处理：

-   需要计算总和的区域为 D 列数值。但并不是要算出 D 列中全部数值的总和。
-   在 A 列中，只计算与 G2的值相同的行的 D 列数值的总和。

**➊ 在单元格 H2内输入以下公式**

=SUMIF(A:A,G2,D:D)

![按照负责人分别计算销售情况——SUMIF函数的基础-Excel22|400](https://www.dgxue.com/excel/img1/image00146.jpeg)

**➋ 按下回车键后，单元格 H2内显示“吉田”负责的销售额。**

![按照负责人分别计算销售情况——SUMIF函数的基础-Excel22|400](https://www.dgxue.com/excel/img1/image00245.jpeg)


#### if 多重条件判断
比如说，如果要表达“B2单元格的值大于等于80为 A，大于等于50为 B，49以下为 C”，就简化为下列公式。

=IF(B2>=80,"A",IF(B2>=50,"B","C"))

乍一看也许有人会觉得这个公式又长又复杂，但它只是在重复下面的程序。

-    **一开始的条件表达式(B2>=80)，如此条件为真，输入值(A)。**
-   **下一个参数，再次从 IF 和括号开始输入。**
-   **接着输入下一个条件表达式。**



### 字符串



#### char()
英文字母 A 对应的字符代码为65。也就是说，输入下列公式的单元格中会显示 A。

=CHAR(65)

将字符代码65改为66则得出 B。也就是说，每次增加1个字符代码且连续输入 CHAR 函数的话，就会在表格中连续输入英文字母。比如，想要从单元格 A2开始沿列连续输入英文字母，那么我们可以在参数中嵌入 ROW 函数，输入以下函数公式：
=CHAR(ROW()+63)

单元格 A2位于工作表的第2行，因此这一公式的 ROW 函数在 A2中会得出2。以2为调整数值加上63，就能得到 A 的字符代码65。

输入这个公式并复制粘贴到其他单元格中，就能输入连续的英文字母了。

**在单元格 A2中输入=CHAR(ROW()+63)，一直复制粘贴到单元格 A27**


#### substitute()
SUBSTITUTE 意为替换

=SUBSTITUTE(B2,"-"," ")

**在单元格 C2中输入=SUBSTITUTE(B2,"-"," ")**

这个函数，是在第一参数指定的字符串的范围内，是将第二参数指定的文字替换为第三参数指定的文字。在这个例子中，第三参数为" "（空白），将连字符替换为空白，就是删除连字符。


#### len() + substitute()
计算特定字符串的数量

字符串| 公式 
---|---
absksdoeqkjsajdalf| =LEN(A32)-LEN(SUBSTITUTE(A32,"a",""))

`=LEN(A32)-LEN(SUBSTITUTE(A32,"a",""))`的结果为3

#### find
**FIND(" ",A2)**
参数1 为想要查找的内容；
参数2 为内容所在的单元格；

#### right/ left/ mid

excel 内的计数顺序是从0 开始的；
left 提取从左边开始的几个字符串，right 提取从右边开始的几个字符串
**=LEFT(A2, num)**

例子：查找被空格隔开的名字和姓氏；
姓氏：**在单元格 B2中输入=LEFT(A2,FIND(" ",A2)-1)**
名字：**在单元格 C2中输入=RIGHT(A2,LEN(A2)-FIND(" ",A2))**

![Excel如何提取单元格内容中空格的前后两部分-Excel22|400](https://www.dgxue.com/excel/img1/image00296.jpeg)

我们既然已经知道分隔文字的半角空格是第3个字符，那么要想提取姓氏，需要从字符串左侧开始应该提取的字符就是3减1，即两个。这样，就能够只提取出“吉田”这两个字，也就是位于字符串最左侧的两个字符。


**=mid(A2,start_num, num_taken)**
=MID(A2,5,2)
MID 函数，第二参数指定开始提取的位置，第三参数指定抽取的字符数。

**在单元格 C2中输入=MID(A2,5,2)**

![代表日期的8位数变为日期数据-Excel22|400](https://www.dgxue.com/excel/img1/image00250.jpeg)

#### exact
判断两个字符串是否相同
如下例，在 A 列中输入了两个相同的电话号码，但是单元格 A2中的数据为全角格式，单元格 A3为半角格式。单元格 B2输有 EXACT 函数（下列公式），用来判定两个字符串内容是否相同。
EXACT 函数，指定参数的两个字符串如果相同为 TRUE，不同则返回 FALSE。因此在该例中，结果为 FALSE（不同）。

=EXACT(A2,A3)

**判断单元格 A2与单元格 A3中的字符串是否相同（单元格 B2）**



### 时间
#### 本质

**输入**
标准输入格式为  2013/11/12，时间的数据形式实际上就是“序列值”，正是这种特殊的序列格式支持了日期之间的数值计算，所以日期算是一种特殊的数值，如1900/1/1 对应为1 ；


例1： 
	按照“以1900年1月1日为第1天”的算法，算出单元格中的日期为第几天。那么，2014年1月1日从1900年1月1日算起正好是第41640天，所以“2014/1/1”的序列值即为41640。

例2：=B2-A2

	这样，从 B2的日期减去 A2日期得到的结果“6”会显示在单元格 C2中。

	单元格 B2的日期数据“2014/4/3”，对应的序列值为41732。

	单元格 A2的日期数据“2014/3/28”，对应的序列值为41726。

	用 B2的序列值减去 A2的序列值，即“41732-41726”，就可以得出“6”这个答案。



**显示**
在excel 
上面的general 是根据输入的内容智能地判断文本类型，此时输入数值就会优先判断成数值，如输入1 就会变成 1；
数值 就是 prescribe 内容为数值；
时间 就是 prescribe 内容为时间， 此时输入1 就会显示 1900/01/01
text 就是 prescribe 内容为文本，此时输入1 就会变成文本，





#### date
转化数值为时间序列
=DATE(2014,1,1)

如何从单元格 A2（数值）的“20131112”中提取年、月、日的数值呢？请大家按照以下思路思考。

-   “年”的数值，提取单元格 A2“20131112”左数4个字符“2013”
-   “月”的数值，提取单元格 A2“20131112”第5个字开始的2个字符“11”
-   “日”的数值，提取单元格 A2“20131112”右数2个字符“12”

=LEFT(A2,4)
=MID(A2,5,2)
=RIGHT(A2,2)
**在单元格 E2中输入=DATE(B2,C2,D2)**

![代表日期的8位数变为日期数据-Excel22](https://www.dgxue.com/excel/img1/image00126.jpeg)

上述的操作步骤可通过以下公式在1个单元格中集中处理。

=DATE(LEFT(A2,4),MID(A2,5,2),RIGHT(A2,2))

#### 星期
##### weekday

##### text
=TEXT(A2,"aaa")
1.Text函数表示将数值转化为自己想要的文本格式
2.text函数的语法格=text(value,format_text）Value     为数字值。Format_text   为设置单元格格式中自己所要选用的文本格式。
**在单元格 B2中输入=TEXT(A2,"aaa")**

![Excel如何从日期设置中导出星期-Excel22|400](https://www.dgxue.com/excel/img1/image00118.jpeg)

这时候，按照第二参数的指定方法，星期几的表示形式则变为：

-   “aaa”➛日
-   “aaaa”➛星期日
-   “ddd”➛Sun
-   “dddd”➛Sunday

#### 年月日
从日期数据中提取出年、月、日的数据，需要用到 YEAR 函数、MONTH 函数、DAY 函数。例如，从单元格 A1中的日期数据分出年、月、日数据，可利用相应的函数按以下方式导出。

-   =YEAR(A1)➛A1的公历年
-   =MONTH(A1)➛A1的月份
-   =DAY(A1)➛A1的日期

#### 时分秒
首先，我们来了解一下 TIME 函数。它是处理时间数据的函数，能够指定时、分、秒。比如要制作“9:30:00”这样的时间数据，我们可以输入下面的公式：

=TIME(9,30,0)

反过来，单元格 A1中含有时间数据（如“9:00”）时，想要从此单元格中分析出小时、分、秒的数值的话，就要用到 HOUR 函数、MINUTE 函数和 SECOND 函数。分别可通过以下公式导出相应的数值。

-   =HOUR(A1) : 导出单元格 A1中时间数据的小时数
-   =MINUTE(A1) : 导出单元格 A1中时间数据的分钟数
-   =SECOND(A1) : 导出单元格 A1中时间数据的秒数

在处理任何时间数据时都可以用下面的函数公式，这样能够导出绝对没有误差的时间数据（假定单元格 A1中含有时间数据）。

=HOUR(A1)*60+MINUTE(A1)

#### 每月多少天
=DAY(EOMONTH(A1,0))  
其中，EOMONTH表示提取一个月最后一天，A1表示为一个任意的日期，0为A1所在月份，如果是1则以A1日期所在月份顺延下个月，-1则是上个月，DAY是提取天数
https://zhidao.baidu.com/question/181734687832254404.html



#### 如何防止被认成日期
即便你不想输入日期，但只要输入“1-11”、“1/21”这类数据，Excel 会自动认定该数据为日期数据，并将其转换成“1月11日”的形式。如果不需要自动转换，可选择下面的方法解决。

-   将单元格的格式设置中的表示形式改为“文本”
-   在开头处输入单引号（'）

顺带一提，想要显示分数形式的话，可通过以下方法输入。

-   将表示形式改为“分数”
-   像“0 1/2”这样的格式，在开头处输入0和半角模式下的空格

### 功能
#### offset
##### 单元格位置偏离（3参数）
=OFFSET(基准单元格,偏离行数,偏离列数)

OFFSET 函数的语法为：“第一参数指定的单元格（基准单元格）开始，第二参数指定向上或向下偏移几行，第三参数指定从第二参数偏离后的位置向右或向左偏移几行”。第二参数为正数则向下移动，为负数则向上移动。第三参数为正数则向右移动，为负数则是向左移动。

例：
  
=OFFSET(A1,B5,B6)

**在单元格 B7中输入=OFFSET(A1,B5,B6)**

![Excel在序列输入时经常会增减选项-Excel22|400](https://www.dgxue.com/excel/img1/image00309.jpeg)

##### 范围偏离（5参数）
=OFFSET(基准单元格,偏移行数,偏移列数,高度,宽度)

** 注意一定要在外面套一个函数，否则单纯的offset只代表一个区域 **
在下表中，B 列为每天的销售额。在单元格 D1中输入想要知道从1号开始到第 N 天的累计销售额的天数，单元格 G1就会自动显示销售额数据。

![Excel在序列输入时经常会增减选项-Excel22|400](https://www.dgxue.com/excel/img1/image00294.jpeg)

此表中，D1的数值为2，销售额 G1中则显示1日～2日两天的累计销售额。

在单元格 G1中，需要输入以下函数公式：

=SUM(OFFSET(B1,1,0,D1,1))

一般要计算数值的和，都会用到 SUM 函数，SUM 函数可计算出括号内指定的单元格范围内的和。SUM 函数括号内的 OFFSET 函数就在指定的单元格范围。

### DataBase函数



## 其他
### 定位功能:find & select
#### `Ctrl` +`Enter`全部填充

例：填充选中区域当中的所有空白单元格，并按照一定逻辑填充
**➊ 选中表内单元格，按快捷键`Ctrl` +`G` 打开【定位】，接着点击【定位条件】选项卡。**

![Excel如何同时删除多个单元格中的文字-Excel22|400](https://www.dgxue.com/excel/img1/image00201.jpeg)

**➋ 【选择】中选择【空值】，点击【确定】。**

![Excel如何同时删除多个单元格中的文字-Excel22|400](https://www.dgxue.com/excel/img1/image00312.jpeg)

**➌ 表格内所有的空白单元格都被选中了。这时请注意，只有 A6是白色（即活动单元格）。**

**➎ 按`Ctrl` +`Enter` 打开“同时输入多个单元格”的界面，被选中的所有单元格中会返回同样的输入结果。**




**条件格式（【开始】➛点击【条件格式】）**

例如，如果对比去年销售额降低了100%，就给这一数据标记颜色。这是根据单元格的数值设定单元格格式的功能。

**数据有效性（【数据】➛点击【数据有效性】）**

如果要多次输入同一数值，可在下拉菜单中选择这一功能。同时，此功能还能限制单元格的输入值，防止输入错误。


### 数据库的筛选排序
Excel 筛选和排序类似于数据库的功能，其运行的必要条件是数据中间不存在空白行
为了方便大家理解，现在和中途有空白行的表格做比较。

空白行下面的部分并不被识别是同一数据库范围，也就是说无法执行排序、自动筛选等操作。如果在进行排序和自动筛选时发现有些数据并不在范围内，就要认真确认表格中间是否存在空白行。


### DataValidation 数据有效性
1、更像一个为了数据呈现而设置的功能
2、只允许输入限定范围值内的数据


### Conditional formatting

#### 公式行填充
**➊ 选择想要设置的范围**

![制作易懂的表格：每隔一行标不同颜色，做成简单易懂的表格-Excel22|400](https://www.dgxue.com/excel/img1/image00287.jpeg)

**➋ 【开始】菜单栏➛【条件格式】➛点击【新建规则】**

**➌ 选择【使用公式确定要设置格式的单元格】**

**➍ 栏目中输入以下公式**

=MOD(ROW(),2)=1

![制作易懂的表格：每隔一行标不同颜色，做成简单易懂的表格-Excel22|400](https://www.dgxue.com/excel/img1/image00181.jpeg)

➎ 【格式】➛在【填充】中选择喜欢的颜色点击确定➛回到【新建规则】点击确定

这样就可以做到给每隔一行填充颜色。

**每隔一行就填充上了颜色**

![制作易懂的表格：每隔一行标不同颜色，做成简单易懂的表格-Excel22|400](https://www.dgxue.com/excel/img1/image00239.jpeg)

#### 条件判断
例如，在计算对比去年的数据的单元格 E3～E11，如果单元格内的数值小于100%，则将此单元格填充为红色。
**➊ 选择单元格范围 E3：E11**
**➌ 选择【使用公式确定要设置格式的单元格】**
**➍ 在【为符合此公式的值设置格式】栏中输入下列公式**
![制作易懂的表格：如何将比去年下降100%的单元格标红-Excel22|300](https://www.dgxue.com/excel/img1/image00272.jpeg)

这时，【为符合此公式的值设置格式】中点击1次，工作表中预先选择的范围里点击只有1处为白色的单元格 E3。